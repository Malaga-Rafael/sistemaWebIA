document.querySelectorAll("button[data-id-orden]").forEach(e=>{e.addEventListener("dblclick",function(){const e=this.getAttribute("data-id-orden");console.log("Mostrando detalle de la orden:",e),async function(e){try{const a=`/api/orden?id=${e}`,n=await fetch(a),o=await n.json();console.log(o);const{orden:t,productos:d}=o.respuesta;console.log(n.resultado);const l=document.createElement("DIV");l.classList.add("modal","modal--grande");let s="";"transferencia"===t.metodoPago&&(s=`\n                    <a href="${t.comprobantePago}" target="_blank" rel="noopenernoreferrer" class="ver-comprobante-btn"aria-label="Ver comprobante de pago">\n                        <i class="fa-solid fa-eye"></i>\n                    </a>\n                `);let i="";i=d.length>0?`\n                <table class="contenedor-tabla">\n                    <thead class="encabezado-tabla">\n                        <tr>\n                            <th>Producto</th>\n                            <th>Cantidad</th>\n                            <th>Precio Unitario</th>\n                        </tr>\n                    </thead>\n                    <tbody class="cuerpo-tabla listado-ordenes">\n                        ${d.map(e=>`\n                            <tr class="producto-orden">\n                                <td>${e.nombreProducto}</td>\n                                <td>${e.cantidadProducto}</td>\n                                <td>$${parseFloat(e.precioProducto).toFixed(2)}</td>\n                            </tr>\n                        `).join("")}\n                    </tbody>\n                </table>\n            `:'<p class="sin-productos">No hay productos en esta orden.</p>';let c="";"domicilio"===t.tipo_pedido&&(c=`\n                    <div class="campo campo-direccion">\n                        <label>Direcci√≥n</label>\n                        <input type="text" value="${t.direccionCompleta}" disabled />\n                    </div>\n\n                    <div class="campo campo-referencia">\n                        <label>Referencia</label>\n                        <input type="text" value="${t.direccionReferencia}" disabled />\n                    </div>\n            `),l.innerHTML=`\n            <form class="formulario">\n                <legend>Detalle de la Orden #${t.id}</legend>\n                \n                <div class= "campos"> \n                    <div class="campo">\n                        <label>Cliente</label>\n                        <input type="text" value="${t.nombreCliente}" disabled />\n                    </div>\n\n                    <div class="campo">\n                        <label>Tipo Pedido</label>\n                        <input type="text" value="${t.tipo_pedido.charAt(0).toUpperCase()+t.tipo_pedido.slice(1)}" disabled />\n                    </div>\n\n                    <div class="campo">\n                        <label>Estatus</label>\n                        <input type="text" value="${t.nombreEstatus}" disabled />\n                    </div>\n\n                    <div class="campo campo-nota">\n                        <label>Nota</label>\n                        <input type="text" value="${t.nota||""}" disabled />\n                    </div>\n                    \n                    ${c}\n                    \n                </div> \n\n                <div class="campo">\n                        <label>Productos</label>\n                </div>\n                ${i}\n\n                <div class= "campos-pago"> \n\n                    <div class="campo">\n                            <label>Total a Pagar</label>\n                            <input type="text" value="${t.montoPago?t.montoPago:"0.00"}" disabled/>\n                    </div>\n\n                    <div class="campo">\n                            <label>Metodo de Pago</label>\n                            <div class="comprobante">\n                                <input type="text" value="${t.metodoPago?t.metodoPago.charAt(0).toUpperCase()+t.metodoPago.slice(1):"Pendiente"}" disabled/>\n                                ${s}\n                            </div>\n                    </div >\n\n                    <div class="campo">\n                        <label>Estado de Pago</label>\n                        <p\n                            class="${t.estadoPago}"\n                        >\n                                ${t.estadoPago.charAt(0).toUpperCase()+t.estadoPago.slice(1)}\n                        </p>\n                    </div>\n                </div>\n\n                <div class="opciones">\n                    <button type="button" class="cerrar-modal">Regresar</button>\n                </div>\n            </form >\n            `,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),l.addEventListener("click",e=>{e.target.classList.contains("cerrar-modal")&&(document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>l.remove(),400))}),document.querySelector(".dashboard").appendChild(l)}catch(e){console.log(e)}}(e)})});